<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è§€æˆ° - é›™äººå°æˆ° 3D è¸©åœ°é›·</title>
    <script>
        // å‹•æ…‹è¼‰å…¥ CSS é¿å…å¿«å–
        const watchCss = document.createElement('link');
        watchCss.rel = 'stylesheet';
        watchCss.href = 'watch.css?v=' + Date.now();
        document.head.appendChild(watchCss);
    </script>
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.154.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.154.0/examples/jsm/"
        }
    }
    </script>
</head>
<body>
    <!-- è¼‰å…¥ä¸­ç•«é¢ -->
    <div id="loading-screen" class="screen">
        <div class="loading-container">
            <h1>ğŸ® è§€æˆ°é€£ç·šä¸­</h1>
            <div class="loading-spinner"></div>
            <p id="loading-status">æ­£åœ¨é€£ç·š...</p>
        </div>
    </div>

    <!-- éŒ¯èª¤ç•«é¢ -->
    <div id="error-screen" class="screen hidden">
        <div class="error-container">
            <h1>ğŸ˜¢ ç„¡æ³•è§€æˆ°</h1>
            <p id="error-message">æˆ¿é–“ä¸å­˜åœ¨æˆ–éŠæˆ²æœªé€²è¡Œä¸­</p>
            <button class="btn btn-primary" onclick="location.href='/'">è¿”å›é¦–é </button>
        </div>
    </div>

    <!-- ç­‰å¾…ç•«é¢ -->
    <div id="waiting-screen" class="screen hidden">
        <div class="waiting-container">
            <h1>â³ ç­‰å¾…ç©å®¶åŠ å…¥</h1>
            <p>æˆ¿é–“ <strong id="waiting-room-code">------</strong> æ­£åœ¨ç­‰å¾…å°æ‰‹åŠ å…¥</p>
            <div class="loading-spinner"></div>
            <p class="waiting-hint">éŠæˆ²é–‹å§‹å¾Œå°‡è‡ªå‹•é€²å…¥è§€æˆ°æ¨¡å¼</p>
            <button class="btn btn-secondary" onclick="location.href='/'">è¿”å›é¦–é </button>
        </div>
    </div>

    <!-- è§€æˆ°ç•«é¢ -->
    <div id="spectate-screen" class="screen hidden">
        <!-- é ‚éƒ¨è³‡è¨Šåˆ— -->
        <div id="top-bar">
            <div class="room-info">
                <span class="room-badge">ğŸ‘ï¸ è§€æˆ°æ¨¡å¼</span>
                <span id="room-code-display">æˆ¿é–“: ------</span>
                <span id="spectator-count">è§€æˆ°äººæ•¸: 1</span>
            </div>
            <div class="game-status">
                <span id="game-status-text">éŠæˆ²é€²è¡Œä¸­</span>
            </div>
        </div>

        <!-- 3D éŠæˆ²ç•«é¢ -->
        <div id="game-canvas-container"></div>

        <!-- å·¦å´ç©å®¶è³‡è¨Š -->
        <div id="players-panel">
            <div class="player-card host" id="host-card">
                <div class="player-label">ğŸ  æˆ¿ä¸»</div>
                <div class="player-name" id="host-name">ç­‰å¾…ä¸­</div>
                <div class="player-score">åˆ†æ•¸: <span id="host-score">0</span></div>
            </div>
            <div class="vs-badge">VS</div>
            <div class="player-card guest" id="guest-card">
                <div class="player-label">ğŸ‘¤ æŒ‘æˆ°è€…</div>
                <div class="player-name" id="guest-name">ç­‰å¾…ä¸­</div>
                <div class="player-score">åˆ†æ•¸: <span id="guest-score">0</span></div>
            </div>
        </div>

        <!-- å›åˆæŒ‡ç¤ºå™¨ -->
        <div id="turn-panel">
            <div class="turn-indicator" id="turn-indicator">ç­‰å¾…éŠæˆ²é–‹å§‹</div>
            <div class="timer-container">
                <span class="timer-label">å‰©é¤˜æ™‚é–“</span>
                <span id="timer-display">--</span>
                <span class="timer-label">ç§’</span>
            </div>
        </div>

        <!-- å½ˆå¹•å´é‚Šæ¬„ -->
        <div id="chat-sidebar">
            <div class="chat-header">
                <h3>ğŸ’¬ è§€çœ¾ç•™è¨€</h3>
                <button id="toggle-chat-btn" class="btn-icon" title="é—œé–‰ç•™è¨€å€">âœ•</button>
            </div>
            <div id="chat-messages"></div>
            <div class="chat-input-area">
                <input type="text" id="nickname-input" placeholder="æš±ç¨± (å¯é¸)" maxlength="10">
                <div class="message-input-row">
                    <input type="text" id="message-input" placeholder="ç™¼é€å½ˆå¹•..." maxlength="50">
                    <button id="send-message-btn" class="btn btn-primary">ç™¼é€</button>
                </div>
                <div class="chat-hint">æŒ‰ Enter ç™¼é€ï¼Œæ¯ 2 ç§’å¯ç™¼é€ä¸€å‰‡</div>
            </div>
        </div>

        <!-- å±•é–‹èŠå¤©æŒ‰éˆ• (èŠå¤©é—œé–‰æ™‚é¡¯ç¤º) -->
        <button id="open-chat-btn" class="btn-floating hidden" title="é–‹å•Ÿç•™è¨€å€">ğŸ’¬</button>

        <!-- éŠæˆ²çµæŸè¦†è“‹å±¤ -->
        <div id="game-over-overlay" class="hidden">
            <div class="game-over-content">
                <h2 id="game-over-result">éŠæˆ²çµæŸ</h2>
                <p id="game-over-message"></p>
                <button class="btn btn-primary" onclick="location.href='/'">è¿”å›é¦–é </button>
            </div>
        </div>
    </div>

    <script>
        // å‹•æ…‹è¼‰å…¥ JS é¿å…å¿«å–
        const script = document.createElement('script');
        script.type = 'module';
        script.src = 'watch.js?v=' + Date.now();
        document.body.appendChild(script);
    </script>
</body>
</html>
