<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¸©åœ°é›·å¾Œå°ç®¡ç†</title>
    <script>
        // å‹•æ…‹è¼‰å…¥ CSS é¿å…å¿«å–
        const adminCss = document.createElement('link');
        adminCss.rel = 'stylesheet';
        adminCss.href = 'admin.css?v=' + Date.now();
        document.head.appendChild(adminCss);
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.154.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.154.0/examples/jsm/"
        }
    }
    </script>
</head>
<body>
    <!-- ç™»å…¥ç•«é¢ -->
    <div id="login-screen" class="screen">
        <div class="login-container">
            <h1>ğŸ® è¸©åœ°é›·å¾Œå°ç®¡ç†</h1>
            <form id="login-form">
                <div class="form-group">
                    <label for="username">å¸³è™Ÿ</label>
                    <input type="text" id="username" name="username" required autocomplete="username">
                </div>
                <div class="form-group">
                    <label for="password">å¯†ç¢¼</label>
                    <input type="password" id="password" name="password" required autocomplete="current-password">
                </div>
                <button type="submit" class="btn btn-primary">ç™»å…¥</button>
                <p id="login-error" class="error"></p>
            </form>
        </div>
    </div>

    <!-- å„€è¡¨æ¿ç•«é¢ -->
    <div id="dashboard-screen" class="screen hidden">
        <header>
            <h1>ğŸ® è¸©åœ°é›·å¾Œå°ç®¡ç†</h1>
            <button id="logout-btn" class="btn btn-secondary">ç™»å‡º</button>
        </header>

        <!-- çµ±è¨ˆè³‡è¨Šå¡ç‰‡ -->
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-icon">ğŸ </div>
                <div class="stat-info">
                    <span class="stat-value" id="total-rooms">0</span>
                    <span class="stat-label">ç¸½æˆ¿é–“æ•¸</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">âš”ï¸</div>
                <div class="stat-info">
                    <span class="stat-value" id="playing-rooms">0</span>
                    <span class="stat-label">å°æˆ°ä¸­</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">â³</div>
                <div class="stat-info">
                    <span class="stat-value" id="waiting-rooms">0</span>
                    <span class="stat-label">ç­‰å¾…ä¸­</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">âœ…</div>
                <div class="stat-info">
                    <span class="stat-value" id="finished-rooms">0</span>
                    <span class="stat-label">å·²çµæŸ</span>
                </div>
            </div>
        </div>

        <!-- åœ–è¡¨å€åŸŸ -->
        <div class="charts-container">
            <div class="chart-card">
                <h3>æˆ¿é–“ç‹€æ…‹åˆ†ä½ˆ</h3>
                <div class="chart-wrapper">
                    <canvas id="roomStatusChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <h3>å³æ™‚æ´»å‹•è¶¨å‹¢</h3>
                <div class="chart-wrapper">
                    <canvas id="activityChart"></canvas>
                </div>
            </div>
        </div>

        <!-- æˆ¿é–“åˆ—è¡¨ -->
        <div class="rooms-container">
            <h2>æˆ¿é–“åˆ—è¡¨</h2>
            <div class="rooms-table-wrapper">
                <table class="rooms-table">
                    <thead>
                        <tr>
                            <th>æˆ¿é–“ä»£ç¢¼</th>
                            <th>ç‹€æ…‹</th>
                            <th>æˆ¿ä¸»</th>
                            <th>è¨ªå®¢</th>
                            <th>å›åˆ</th>
                            <th>æ™‚é–“</th>
                            <th>éŠç©æ™‚é•·</th>
                            <th>è§€æˆ°äººæ•¸</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="rooms-tbody">
                        <tr>
                            <td colspan="9" class="no-data">ç›®å‰æ²’æœ‰æˆ¿é–“</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- è§€æˆ°ç•«é¢ -->
    <div id="spectate-screen" class="screen hidden">
        <header class="spectate-header">
            <button id="back-to-dashboard" class="btn btn-secondary">â† è¿”å›å„€è¡¨æ¿</button>
            <div class="spectate-info">
                <span id="spectate-room-code">æˆ¿é–“: ---</span>
                <span id="spectate-count">ğŸ‘ï¸ è§€æˆ°äººæ•¸: 0</span>
            </div>
        </header>

        <!-- éŠæˆ²è³‡è¨Šé¢æ¿ -->
        <div class="game-info-panel">
            <div class="player-info host-info">
                <span class="player-label">æˆ¿ä¸»</span>
                <span class="player-name" id="spectate-host-name">---</span>
                <span class="player-score" id="spectate-host-score">0 åˆ†</span>
            </div>
            <div class="game-status-center">
                <div class="turn-indicator" id="spectate-turn">ç­‰å¾…é–‹å§‹</div>
                <div class="timer" id="spectate-timer">--</div>
            </div>
            <div class="player-info guest-info">
                <span class="player-label">è¨ªå®¢</span>
                <span class="player-name" id="spectate-guest-name">---</span>
                <span class="player-score" id="spectate-guest-score">0 åˆ†</span>
            </div>
        </div>

        <!-- 3D éŠæˆ²ç•«å¸ƒå®¹å™¨ -->
        <div id="game-canvas-container"></div>

        <!-- åœ–ä¾‹ -->
        <div class="legend">
            <div class="legend-item">
                <span class="legend-color mine-color"></span>
                <span>åœ°é›·ä½ç½®ï¼ˆè§€æˆ°è€…å¯è¦‹ï¼‰</span>
            </div>
        </div>
    </div>

    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>
    <script>
        // å‹•æ…‹è¼‰å…¥ JS é¿å…å¿«å–
        const script = document.createElement('script');
        script.type = 'module';
        script.src = 'admin.js?v=' + Date.now();
        document.body.appendChild(script);
    </script>
</body>
</html>
